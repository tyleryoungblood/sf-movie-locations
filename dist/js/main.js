var app=angular.module("FilmApp",["angular.filter"]);
app.service("DataService",["$http","$q",function(e,t){this.getData=function(){var r=t.defer();return e.get("https://data.sfgov.org/resource/wwmu-gmzc.json").then(function(e){return r.resolve(e.data)},function(e){return console.error("Error while fetching users"),t.reject(e)}),r.promise}}]);
app.controller("FilmCtrl",["$scope","$http","DataService",function(l,e,t){t.getData().then(function(e){l.films=e;var a=new google.maps.Map(document.getElementById("map-canvas"),{zoom:12,center:new google.maps.LatLng(37.7749,-122.4194),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]}),n=new google.maps.InfoWindow,t=new google.maps.Geocoder,y=[];function o(s){t.geocode({address:s.locations},function(e,t){var o,l,r;t==google.maps.GeocoderStatus.OK?(o=e[0].geometry.location,l="<h1>"+s.title+"</h1><br><b>Location:</b> "+s.locations+"<br><b>Director:</b> "+s.director,r=new google.maps.Marker({position:o,map:a}),y.push(r),google.maps.event.addListener(r,"mouseover",function(){n.setContent(l),n.open(a,r)}),google.maps.event.addListener(r,"mouseout",function(){n.close()})):console.log("An error occurred: "+t)})}l.updateMap=function(e){for(function(){for(var e=0;e<y.length;e++)y[e].setMap(null);y=[]}(),console.log("inside updateMap()"),console.log(e),i=0;i<l.films.length;i++)l.films[i].title===e&&o(l.films[i])}})}]);