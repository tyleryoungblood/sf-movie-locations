var app=angular.module("FilmApp",["angular.filter"]);
app.service("DataService",["$http","$q",function(e,t){this.getData=function(){var r=t.defer();return e.get("https://data.sfgov.org/resource/wwmu-gmzc.json").then(function(e){return r.resolve(e.data)},function(e){return console.error("Error while fetching users"),t.reject(e)}),r.promise}}]);
app.controller("FilmCtrl",["$scope","$http","DataService",function(t,o,e){e.getData().then(function(o){t.films=o;var l=new google.maps.Map(document.getElementById("map_canvas"),{zoom:12,center:new google.maps.LatLng(37.7749,-122.4194),mapTypeId:google.maps.MapTypeId.ROADMAP}),s=new google.maps.InfoWindow,e=new google.maps.Geocoder,r=[];function n(i){e.geocode({address:i.locations},function(o,e){var n,t,a;e==google.maps.GeocoderStatus.OK?(n=o[0].geometry.location,t="<h1>"+i.title+"</h1><br><b>Location:</b> "+i.locations+"<br><b>Director:</b> "+i.director,a=new google.maps.Marker({position:n,map:l}),r.push(a),google.maps.event.addListener(a,"mouseover",function(){s.setContent(t),s.open(l,a)}),google.maps.event.addListener(a,"mouseout",function(){s.close()})):console.log("An error occurred: "+e)})}t.updateMap=function(o){for(function(){for(var o=0;o<r.length;o++)r[o].setMap(null);r=[]}(),console.log("inside updateMap()"),console.log(o),i=0;i<t.films.length;i++)t.films[i].title===o&&n(t.films[i])}})}]);